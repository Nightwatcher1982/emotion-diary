"use strict";const e=require("../../common/vendor.js"),t=e.defineComponent({__name:"feedback",setup(t){const n=e.ref("bug"),a=e.ref("medium"),i=e.ref(!1),o=e.reactive({description:"",steps:[""],attachments:[],email:"",phone:""}),s=[{key:"bug",name:"问题反馈",description:"应用出现错误或异常",icon:"🐛"},{key:"feature",name:"功能建议",description:"希望添加新功能",icon:"💡"},{key:"improvement",name:"改进建议",description:"现有功能的改进意见",icon:"⚡"},{key:"ui",name:"界面问题",description:"界面显示或交互问题",icon:"🎨"},{key:"performance",name:"性能问题",description:"应用运行缓慢或卡顿",icon:"🚀"},{key:"other",name:"其他",description:"其他类型的反馈",icon:"📝"}],c=[{key:"low",name:"低",icon:"🟢"},{key:"medium",name:"中",icon:"🟡"},{key:"high",name:"高",icon:"🟠"},{key:"urgent",name:"紧急",icon:"🔴"}],r=e.ref({appVersion:"v1.0.0",systemVersion:"iOS 17.5",deviceModel:"iPhone 15 Pro",userId:"user_123456"}),u=e.ref([{id:1,type:"bug",title:"登录页面无法正常显示",status:"resolved",createdAt:"2024-06-20T10:30:00Z"},{id:2,type:"feature",title:"希望添加夜间模式",status:"processing",createdAt:"2024-06-18T14:20:00Z"},{id:3,type:"improvement",title:"情绪记录页面加载优化",status:"pending",createdAt:"2024-06-15T09:15:00Z"}]),d=e.computed(()=>({bug:["应用崩溃","功能无法使用","数据显示错误","页面加载失败"],feature:["希望添加...","建议增加...","期望支持..."],improvement:["建议优化...","希望改进...","可以更好..."],ui:["界面显示异常","按钮无法点击","文字显示不全","颜色搭配问题"],performance:["启动速度慢","页面卡顿","内存占用高","电池消耗快"]}[n.value]||[])),l=e.computed(()=>o.description.trim().length>=10),p=()=>{o.steps.push("")},m=()=>{e.index.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{e.tempFilePaths.forEach(e=>{o.attachments.push({name:`image_${Date.now()}.jpg`,url:e,type:"image"})})}})},v=()=>{i.value=!i.value},y=e=>{const t=s.find(t=>t.key===e);return t?t.icon:"📝"},g=e=>({pending:"待处理",processing:"处理中",resolved:"已解决",closed:"已关闭"}[e]||"未知"),f=e=>{const t=new Date(e),n=(new Date).getTime()-t.getTime(),a=Math.floor(n/864e5);return 0===a?"今天":1===a?"昨天":a<7?`${a}天前`:t.toLocaleDateString("zh-CN")},h=()=>{e.index.navigateTo({url:"/pages/help/feedback-history"})},k=()=>{l.value?(e.index.showLoading({title:"提交中..."}),setTimeout(()=>{e.index.hideLoading(),e.index.showModal({title:"提交成功",content:"感谢您的反馈！我们会尽快处理您的问题。",showCancel:!1,success:()=>{o.description="",o.steps=[""],o.attachments=[],o.email="",o.phone="",n.value="bug",a.value="medium",setTimeout(()=>{e.index.navigateBack()},1e3)}})},2e3)):e.index.showToast({title:"请完善反馈内容",icon:"none"})};return e.onMounted(()=>{e.index.getSystemInfo({success:e=>{r.value={appVersion:"v1.0.0",systemVersion:`${e.platform} ${e.system}`,deviceModel:e.model,userId:"user_123456"}}})}),(t,b)=>e.e({a:e.f(s,(t,a,i)=>e.e({a:e.t(t.icon),b:e.t(t.name),c:e.t(t.description),d:n.value===t.key},(n.value,t.key,{}),{e:t.key,f:n.value===t.key?1:"",g:e.o(e=>(e=>{n.value=e})(t.key),t.key)})),b:o.description,c:e.o(e=>o.description=e.detail.value),d:e.t(o.description.length),e:e.unref(d).length>0},e.unref(d).length>0?{f:e.f(e.unref(d),(t,n,a)=>({a:e.t(t),b:t,c:e.o(e=>(e=>{o.description=e})(t),t)}))}:{},{g:"bug"===n.value},"bug"===n.value?{h:e.f(o.steps,(t,n,a)=>({a:e.t(n+1),b:o.steps[n],c:e.o(e=>o.steps[n]=e.detail.value,n),d:e.o(e=>(e=>{o.steps.length>1&&o.steps.splice(e,1)})(n),n),e:n})),i:e.o(p)}:{},{j:e.f(c,(t,n,i)=>({a:e.t(t.icon),b:e.t(t.name),c:t.key,d:a.value===t.key?1:"",e:t.key,f:e.o(e=>(e=>{a.value=e})(t.key),t.key)})),k:e.f(o.attachments,(t,n,a)=>e.e({a:"image"===t.type},"image"===t.type?{b:t.url}:{c:e.t(t.name)},{d:e.o(e=>(e=>{o.attachments.splice(e,1)})(n),n),e:n})),l:e.o(m),m:o.email,n:e.o(e=>o.email=e.detail.value),o:o.phone,p:e.o(e=>o.phone=e.detail.value),q:i.value?1:"",r:e.o(v),s:i.value},i.value?{t:e.t(r.value.appVersion),v:e.t(r.value.systemVersion),w:e.t(r.value.deviceModel),x:e.t(r.value.userId)}:{},{y:e.o(h),z:e.f(u.value,(t,n,a)=>({a:e.t(y(t.type)),b:e.t(t.title),c:e.t(f(t.createdAt)),d:e.t(g(t.status)),e:e.n(t.status),f:t.id,g:e.o(n=>(t=>{e.index.showModal({title:t.title,content:`状态：${g(t.status)}\n提交时间：${f(t.createdAt)}`,showCancel:!1})})(t),t.id)})),A:e.unref(l)?"":1,B:e.o(k),C:!e.unref(l)})}}),n=e._export_sfc(t,[["__scopeId","data-v-df4175ca"]]);wx.createPage(n);
