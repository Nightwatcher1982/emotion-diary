import{g as e,r as a,h as l,j as t,o as s,c as n,w as i,b as c,a as u,d as o,t as d,l as r,m as f,F as _,u as v,e as g,i as m,A as h,I as p,s as b,B as k,x as y,f as x,n as w}from"./index-6afd3b48.js";import{c as C,a as T,b as V}from"./api.ae518a48.js";import{_ as j}from"./_plugin-vue_export-helper.1b428a4d.js";const F=j(e({__name:"edit",setup(e){const j=a({nickname:"",bio:"",gender:"N",birth_date:"",avatar:"",notification_enabled:!0,daily_reminder_time:"21:00",theme_preference:"auto",analytics_consent:!0}),F=a(!1),I=a([{value:"M",label:"ç”·",icon:"ğŸ‘¨"},{value:"F",label:"å¥³",icon:"ğŸ‘©"},{value:"O",label:"å…¶ä»–",icon:"ğŸ§‘"},{value:"N",label:"ä¿å¯†",icon:"ğŸ¤"}]),L=a(["è·Ÿéšç³»ç»Ÿ","æµ…è‰²ä¸»é¢˜","æ·±è‰²ä¸»é¢˜"]),N=a(0),B=l(()=>({auto:"è·Ÿéšç³»ç»Ÿ",light:"æµ…è‰²ä¸»é¢˜",dark:"æ·±è‰²ä¸»é¢˜"}[j.value.theme_preference]||"è·Ÿéšç³»ç»Ÿ")),P=()=>{uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{j.value.avatar=e.tempFilePaths[0],uni.showToast({title:"å¤´åƒå·²é€‰æ‹©",icon:"success"})},fail:()=>{uni.showToast({title:"é€‰æ‹©å¤´åƒå¤±è´¥",icon:"none"})}})},U=e=>{j.value.birth_date=e.detail.value},z=e=>{const a=e.detail.value;N.value=a;j.value.theme_preference=["auto","light","dark"][a]},A=e=>{j.value.notification_enabled=e.detail.value},M=e=>{j.value.daily_reminder_time=e.detail.value},O=e=>{j.value.analytics_consent=e.detail.value},q=async()=>{var e,a;if(!F.value)try{if(F.value=!0,!j.value.nickname.trim())return void uni.showToast({title:"è¯·è¾“å…¥æ˜µç§°",icon:"none"});uni.showLoading({title:"ä¿å­˜ä¸­..."});await T.updateProfile(j.value);const e=C();if(e){const a={...e,...j.value};V(a)}uni.hideLoading(),uni.showToast({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),setTimeout(()=>{uni.navigateBack()},1500)}catch(l){uni.hideLoading(),console.error("ä¿å­˜å¤±è´¥:",l);const t=(null==(a=null==(e=null==l?void 0:l.response)?void 0:e.data)?void 0:a.message)||"ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•";uni.showToast({title:t,icon:"none"})}finally{F.value=!1}};return t(()=>{(async()=>{try{const e=C();if(e){j.value={nickname:e.nickname||"",bio:e.bio||"",gender:e.gender||"N",birth_date:e.birth_date||"",avatar:e.avatar||"",notification_enabled:!1!==e.notification_enabled,daily_reminder_time:e.daily_reminder_time||"21:00",theme_preference:e.theme_preference||"auto",analytics_consent:!1!==e.analytics_consent};const a={auto:0,light:1,dark:2};N.value=a[j.value.theme_preference]||0}}catch(e){console.error("åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",e),uni.showToast({title:"åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}})()}),(e,a)=>{const l=g,t=m,C=h,T=p,V=b,D=k,E=y,G=x;return s(),n(t,{class:"container"},{default:i(()=>[c(" é¡µé¢å¤´éƒ¨ "),u(t,{class:"page-header"},{default:i(()=>[u(t,{class:"header-content"},{default:i(()=>[u(l,{class:"page-title"},{default:i(()=>[o("ç¼–è¾‘èµ„æ–™")]),_:1}),u(l,{class:"page-subtitle"},{default:i(()=>[o("å®Œå–„ä¸ªäººä¿¡æ¯ï¼Œè·å¾—æ›´å¥½çš„ä½“éªŒ")]),_:1})]),_:1})]),_:1}),c(" å¤´åƒç¼–è¾‘åŒºåŸŸ "),u(t,{class:"avatar-section glass-card"},{default:i(()=>[u(t,{class:"avatar-container",onClick:P},{default:i(()=>[u(C,{class:"avatar-image",src:j.value.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"]),u(t,{class:"avatar-overlay"},{default:i(()=>[u(l,{class:"camera-icon"},{default:i(()=>[o("ğŸ“·")]),_:1}),u(l,{class:"change-text"},{default:i(()=>[o("æ›´æ¢å¤´åƒ")]),_:1})]),_:1}),u(t,{class:"avatar-glow"})]),_:1}),u(l,{class:"avatar-tip"},{default:i(()=>[o("ç‚¹å‡»æ›´æ¢å¤´åƒ")]),_:1})]),_:1}),c(" åŸºæœ¬ä¿¡æ¯ç¼–è¾‘ "),u(t,{class:"form-section glass-card"},{default:i(()=>[u(t,{class:"section-header"},{default:i(()=>[u(l,{class:"section-title"},{default:i(()=>[o("åŸºæœ¬ä¿¡æ¯")]),_:1})]),_:1}),u(t,{class:"form-group"},{default:i(()=>[u(l,{class:"form-label"},{default:i(()=>[o("æ˜µç§°")]),_:1}),u(T,{class:"form-input",modelValue:j.value.nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value.nickname=e),placeholder:"è¯·è¾“å…¥æ˜µç§°",maxlength:"50"},null,8,["modelValue"]),u(t,{class:"input-underline"})]),_:1}),u(t,{class:"form-group"},{default:i(()=>[u(l,{class:"form-label"},{default:i(()=>[o("ä¸ªäººç®€ä»‹")]),_:1}),u(V,{class:"form-textarea",modelValue:j.value.bio,"onUpdate:modelValue":a[1]||(a[1]=e=>j.value.bio=e),placeholder:"ä»‹ç»ä¸€ä¸‹è‡ªå·±å§...",maxlength:"500","auto-height":""},null,8,["modelValue"]),u(t,{class:"char-count"},{default:i(()=>{var e;return[o(d((null==(e=j.value.bio)?void 0:e.length)||0)+"/500",1)]}),_:1}),u(t,{class:"input-underline"})]),_:1}),u(t,{class:"form-group"},{default:i(()=>[u(l,{class:"form-label"},{default:i(()=>[o("æ€§åˆ«")]),_:1}),u(t,{class:"gender-options"},{default:i(()=>[(s(!0),r(_,null,f(I.value,e=>(s(),n(t,{class:w(["gender-option",{active:j.value.gender===e.value}]),key:e.value,onClick:a=>{return l=e.value,void(j.value.gender=l);var l}},{default:i(()=>[u(l,{class:"gender-icon"},{default:i(()=>[o(d(e.icon),1)]),_:2},1024),u(l,{class:"gender-text"},{default:i(()=>[o(d(e.label),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),u(t,{class:"form-group"},{default:i(()=>[u(l,{class:"form-label"},{default:i(()=>[o("å‡ºç”Ÿæ—¥æœŸ")]),_:1}),u(D,{mode:"date",value:j.value.birth_date,onChange:U,class:"date-picker"},{default:i(()=>[u(t,{class:"picker-display"},{default:i(()=>[u(l,{class:"picker-text"},{default:i(()=>[o(d(j.value.birth_date||"è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ"),1)]),_:1}),u(l,{class:"picker-icon"},{default:i(()=>[o("ğŸ“…")]),_:1})]),_:1})]),_:1},8,["value"]),u(t,{class:"input-underline"})]),_:1})]),_:1}),c(" åº”ç”¨è®¾ç½® "),u(t,{class:"settings-section glass-card"},{default:i(()=>[u(t,{class:"section-header"},{default:i(()=>[u(l,{class:"section-title"},{default:i(()=>[o("åº”ç”¨è®¾ç½®")]),_:1})]),_:1}),u(t,{class:"setting-item"},{default:i(()=>[u(t,{class:"setting-info"},{default:i(()=>[u(l,{class:"setting-icon"},{default:i(()=>[o("ğŸŒ™")]),_:1}),u(t,{class:"setting-text"},{default:i(()=>[u(l,{class:"setting-name"},{default:i(()=>[o("ä¸»é¢˜æ¨¡å¼")]),_:1}),u(l,{class:"setting-desc"},{default:i(()=>[o("é€‰æ‹©æ‚¨å–œæ¬¢çš„ä¸»é¢˜é£æ ¼")]),_:1})]),_:1})]),_:1}),u(D,{range:L.value,value:N.value,onChange:z},{default:i(()=>[u(t,{class:"setting-value"},{default:i(()=>[u(l,null,{default:i(()=>[o(d(v(B)),1)]),_:1}),u(l,{class:"arrow-icon"},{default:i(()=>[o(">")]),_:1})]),_:1})]),_:1},8,["range","value"])]),_:1}),u(t,{class:"setting-item"},{default:i(()=>[u(t,{class:"setting-info"},{default:i(()=>[u(l,{class:"setting-icon"},{default:i(()=>[o("ğŸ””")]),_:1}),u(t,{class:"setting-text"},{default:i(()=>[u(l,{class:"setting-name"},{default:i(()=>[o("æ¨é€é€šçŸ¥")]),_:1}),u(l,{class:"setting-desc"},{default:i(()=>[o("æ¥æ”¶æƒ…ç»ªæé†’å’Œåˆ†ææŠ¥å‘Š")]),_:1})]),_:1})]),_:1}),u(E,{checked:j.value.notification_enabled,onChange:A,color:"#667eea"},null,8,["checked"])]),_:1}),j.value.notification_enabled?(s(),n(t,{key:0,class:"setting-item"},{default:i(()=>[u(t,{class:"setting-info"},{default:i(()=>[u(l,{class:"setting-icon"},{default:i(()=>[o("â°")]),_:1}),u(t,{class:"setting-text"},{default:i(()=>[u(l,{class:"setting-name"},{default:i(()=>[o("æé†’æ—¶é—´")]),_:1}),u(l,{class:"setting-desc"},{default:i(()=>[o("æ¯æ—¥æƒ…ç»ªè®°å½•æé†’")]),_:1})]),_:1})]),_:1}),u(D,{mode:"time",value:j.value.daily_reminder_time,onChange:M},{default:i(()=>[u(t,{class:"setting-value"},{default:i(()=>[u(l,null,{default:i(()=>[o(d(j.value.daily_reminder_time||"21:00"),1)]),_:1}),u(l,{class:"arrow-icon"},{default:i(()=>[o(">")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})):c("v-if",!0),u(t,{class:"setting-item"},{default:i(()=>[u(t,{class:"setting-info"},{default:i(()=>[u(l,{class:"setting-icon"},{default:i(()=>[o("ğŸ›¡ï¸")]),_:1}),u(t,{class:"setting-text"},{default:i(()=>[u(l,{class:"setting-name"},{default:i(()=>[o("æ•°æ®åˆ†æ")]),_:1}),u(l,{class:"setting-desc"},{default:i(()=>[o("å…è®¸åˆ†ææ‚¨çš„æƒ…ç»ªæ•°æ®")]),_:1})]),_:1})]),_:1}),u(E,{checked:j.value.analytics_consent,onChange:O,color:"#667eea"},null,8,["checked"])]),_:1})]),_:1}),c(" ä¿å­˜æŒ‰é’® "),u(t,{class:"save-section"},{default:i(()=>[u(G,{class:"save-button",onClick:q,disabled:F.value},{default:i(()=>[u(t,{class:"button-content"},{default:i(()=>[F.value?c("v-if",!0):(s(),n(l,{key:0,class:"save-icon"},{default:i(()=>[o("ğŸ’¾")]),_:1})),F.value?(s(),n(t,{key:1,class:"loading-spinner"})):c("v-if",!0),u(l,{class:"save-text"},{default:i(()=>[o(d(F.value?"ä¿å­˜ä¸­...":"ä¿å­˜ä¿®æ”¹"),1)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-16615573"]]);export{F as default};
